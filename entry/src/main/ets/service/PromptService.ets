import { promptAction } from '@kit.ArkUI'
import { PlayMode } from '../model/PlayState'

/**
 * æ’­æ”¾æ¨¡å¼ä¿¡æ¯æ¥å£
 */
interface PlayModeInfo {
  name: string
  icon: string
  description: string
}

/**
 * æç¤ºæœåŠ¡
 * æä¾›ç»Ÿä¸€çš„ Toastã€å¯¹è¯æ¡†ç­‰æç¤ºåŠŸèƒ½
 */
export class PromptService {
  private static instance: PromptService | null = null

  private constructor() {}

  static getInstance(): PromptService {
    if (!PromptService.instance) {
      PromptService.instance = new PromptService()
    }
    return PromptService.instance
  }

  /**
   * æ˜¾ç¤º Toast æç¤º
   * @param message æç¤ºæ¶ˆæ¯
   * @param duration æ˜¾ç¤ºæ—¶é•¿ï¼ˆæ¯«ç§’ï¼‰ï¼Œé»˜è®¤ 2000ms
   */
  showToast(message: string, duration: number = 2000): void {
    try {
      promptAction.showToast({
        message: message,
        duration: duration,
        bottom: 100
      })
    } catch (error) {
      console.error('PromptService', `Show toast failed: ${JSON.stringify(error)}`)
    }
  }

  /**
   * æ˜¾ç¤ºæ’­æ”¾æ¨¡å¼åˆ‡æ¢æç¤º
   * @param playMode æ–°çš„æ’­æ”¾æ¨¡å¼
   */
  showPlayModeToast(playMode: PlayMode): void {
    const modeInfo = this.getPlayModeInfo(playMode)
    this.showToast(`${modeInfo.icon} ${modeInfo.name}\n${modeInfo.description}`, 2000)
  }

  /**
   * è·å–æ’­æ”¾æ¨¡å¼ä¿¡æ¯
   */
  private getPlayModeInfo(playMode: PlayMode): PlayModeInfo {
    switch (playMode) {
      case PlayMode.SEQUENCE:
        const sequenceInfo: PlayModeInfo = {
          name: 'é¡ºåºæ’­æ”¾',
          icon: 'â–¶ï¸',
          description: 'æŒ‰åˆ—è¡¨é¡ºåºæ’­æ”¾æ­Œæ›²'
        }
        return sequenceInfo
      case PlayMode.LOOP:
        const loopInfo: PlayModeInfo = {
          name: 'åˆ—è¡¨å¾ªç¯',
          icon: 'ğŸ”',
          description: 'æ’­æ”¾å®Œåé‡æ–°å¼€å§‹'
        }
        return loopInfo
      case PlayMode.SINGLE:
        const singleInfo: PlayModeInfo = {
          name: 'å•æ›²å¾ªç¯',
          icon: 'ğŸ”‚',
          description: 'é‡å¤æ’­æ”¾å½“å‰æ­Œæ›²'
        }
        return singleInfo
      case PlayMode.SMART_SHUFFLE:
        const smartShuffleInfo: PlayModeInfo = {
          name: 'æ™ºèƒ½éšæœº',
          icon: 'ğŸ§ ',
          description: 'é¿å…åŒé£æ ¼/ä¸“è¾‘è¿ç»­æ’­æ”¾'
        }
        return smartShuffleInfo
      case PlayMode.TIME_AWARE:
        const timeAwareInfo: PlayModeInfo = {
          name: 'æ—¶é—´æ„ŸçŸ¥',
          icon: 'ğŸ•’',
          description: 'æ ¹æ®æ—¶æ®µæ™ºèƒ½é€‰æ­Œ'
        }
        return timeAwareInfo
      case PlayMode.NIGHT_MODE:
        const nightModeInfo: PlayModeInfo = {
          name: 'å¤œé—´æ¨¡å¼',
          icon: 'ğŸŒ™',
          description: 'èˆ’ç¼“éŸ³ä¹ï¼ŒéŸ³é‡æ¸å¼±'
        }
        return nightModeInfo
      default:
        const defaultInfo: PlayModeInfo = {
          name: 'é¡ºåºæ’­æ”¾',
          icon: 'â–¶ï¸',
          description: 'æŒ‰åˆ—è¡¨é¡ºåºæ’­æ”¾æ­Œæ›²'
        }
        return defaultInfo
    }
  }

  /**
   * æ˜¾ç¤ºé”™è¯¯æç¤º
   */
  showError(message: string): void {
    this.showToast(`âŒ ${message}`, 2500)
  }

  /**
   * æ˜¾ç¤ºæˆåŠŸæç¤º
   */
  showSuccess(message: string): void {
    this.showToast(`âœ… ${message}`, 2000)
  }

  /**
   * æ˜¾ç¤ºä¿¡æ¯æç¤º
   */
  showInfo(message: string): void {
    this.showToast(`â„¹ï¸ ${message}`, 2000)
  }

  /**
   * æ˜¾ç¤ºè­¦å‘Šæç¤º
   */
  showWarning(message: string): void {
    this.showToast(`âš ï¸ ${message}`, 2500)
  }
}
